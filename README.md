# FlutteråŠ¨æ€SOåŠ è½½æ–¹æ¡ˆ

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„FlutteråŠ¨æ€SOåŠ è½½è§£å†³æ–¹æ¡ˆï¼Œå®ç°äº†ï¼š
- ç¼–è¯‘æ—¶è‡ªåŠ¨ä»APKæ„å»ºäº§ç‰©ä¸­æå–çœŸå®çš„Flutter SOæ–‡ä»¶
- è¿è¡Œæ—¶ä»æœåŠ¡å™¨åŠ¨æ€ä¸‹è½½å¹¶åŠ è½½SOæ–‡ä»¶
- APKä½“ç§¯å‡å°‘çº¦70%ï¼ˆç§»é™¤SOæ–‡ä»¶ï¼‰
- æ”¯æŒå¤šæ¶æ„ï¼ˆarm64-v8a, armeabi-v7aï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡å™¨
```bash
# å…ˆå¯åŠ¨SOåŒ…åˆ†å‘æœåŠ¡å™¨ï¼ˆæ„å»ºæ—¶éœ€è¦ä¸Šä¼ SOåŒ…åˆ°æœåŠ¡å™¨ï¼‰
cd dart_server && ./server.sh
```

### 2. æ„å»ºé¡¹ç›®
```bash
# æ„å»ºAPKï¼ˆè‡ªåŠ¨æå–å¹¶ä¸Šä¼ çœŸå®SOåŒ…åˆ°æœåŠ¡å™¨ï¼‰
./gradlew assembleRelease
```

### 3. å®‰è£…æµ‹è¯•
```bash
# å®‰è£…APKåˆ°è®¾å¤‡
adb install -r app/build/outputs/apk/release/app-release.apk

# å¯åŠ¨åº”ç”¨
adb shell am start -n com.example.flutterdynamic/.MainActivity
```

## ğŸ“± ä½¿ç”¨æ–¹æ³•

1. **æ‰“å¼€åº”ç”¨** - ç‚¹å‡»æ¡Œé¢å›¾æ ‡å¯åŠ¨
2. **ç‚¹å‡»"å¯åŠ¨Flutter"** - ä½“éªŒåŠ¨æ€SOåŠ è½½
3. **ç‚¹å‡»"åŠ¨æ€SOæµ‹è¯•å·¥å…·"** - è¿è¡Œå®Œæ•´åŠŸèƒ½æµ‹è¯•

## ğŸ”§ æœåŠ¡å™¨ç®¡ç†

```bash
cd dart_server

./server.sh          # å¯åŠ¨æœåŠ¡å™¨ï¼ˆè‡ªåŠ¨æ€æ‰ä¹‹å‰çš„è¿›ç¨‹ï¼‰
```

## ğŸ“¦ SOåŒ…ä¿¡æ¯

- **libflutter_3.19.5.zip** (9MB) - Flutterå¼•æ“SOæ–‡ä»¶
- **libapp_1.0.0.zip** (2.5MB) - Flutteråº”ç”¨SOæ–‡ä»¶

## ğŸ¯ æŠ€æœ¯ç‰¹ç‚¹

- âœ… **çœŸå®SOæ–‡ä»¶**: ä»APKæ„å»ºäº§ç‰©æå–ï¼Œéæ¨¡æ‹Ÿæ–‡ä»¶
- âœ… **è‡ªåŠ¨åŒ–å¤„ç†**: æ„å»ºæ—¶è‡ªåŠ¨æå–å¹¶ä¸Šä¼ SOåŒ…
- âœ… **ç½‘ç»œé€šä¿¡**: ADBåå‘ç«¯å£æ˜ å°„ï¼Œæ‰‹æœºè®¿é—®ç”µè„‘æœåŠ¡å™¨
- âœ… **å®Œæ•´æ€§æ ¡éªŒ**: MD5å’Œæ–‡ä»¶å¤§å°åŒé‡éªŒè¯
- âœ… **ç‰ˆæœ¬ç®¡ç†**: è‡ªåŠ¨è¯†åˆ«Flutterç‰ˆæœ¬
- âœ… **å¤šæ¶æ„æ”¯æŒ**: arm64-v8aå’Œarmeabi-v7a

## ğŸ“ é¡¹ç›®ç»“æ„

```
dynamicLoadFLutterSo/
â”œâ”€â”€ README.md                        # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ app/                             # Androidåº”ç”¨
â”‚   â”œâ”€â”€ src/main/assets/flutterso.json  # SOåŒ…é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ src/main/java/.../           # åŠ¨æ€åŠ è½½æ ¸å¿ƒä»£ç 
â”œâ”€â”€ dart_server/                     # SOåŒ…åˆ†å‘æœåŠ¡å™¨
â”‚   â”œâ”€â”€ server.sh                    # æœåŠ¡å™¨ç®¡ç†è„šæœ¬
â”‚   â”œâ”€â”€ bin/server.dart              # æœåŠ¡å™¨ä¸»ç¨‹åº
â”‚   â””â”€â”€ so_packages/                 # SOåŒ…å­˜å‚¨ç›®å½•
â”œâ”€â”€ flutter_module/                  # Flutteræ¨¡å—
â””â”€â”€ buildSrc/                        # Gradleæ’ä»¶ï¼ˆè‡ªåŠ¨å¤„ç†SOåŒ…ï¼‰
```

## ğŸ› ï¸ æ ¸å¿ƒç»„ä»¶

### Androidç«¯
- **FlutterManager.kt** - SOåŠ è½½ç®¡ç†å™¨
- **SoPackageManager.kt** - SOåŒ…ç®¡ç†å™¨
- **DynamicFlutterActivity.kt** - Flutterç•Œé¢
- **DynamicSoTestActivity.kt** - æµ‹è¯•å·¥å…·

### æœåŠ¡å™¨ç«¯
- **server.dart** - HTTPæœåŠ¡å™¨ï¼Œæä¾›SOåŒ…ä¸‹è½½
- **server.sh** - æœåŠ¡å™¨ç®¡ç†è„šæœ¬

### æ„å»ºå·¥å…·
- **FlutterDynamicPlugin.java** - Gradleæ’ä»¶ï¼ˆè‡ªåŠ¨æå–SOæ–‡ä»¶å¹¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰
- **EngineSoDynamicTask.java** - Flutterå¼•æ“SOå¤„ç†ä»»åŠ¡
- **AppSoDynamicTask.java** - Flutteråº”ç”¨SOå¤„ç†ä»»åŠ¡

## ğŸ”„ è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹

### æ„å»ºæ—¶è‡ªåŠ¨å¤„ç†
### æ„å»ºæ—¶è‡ªåŠ¨å¤„ç†
1. **å¯åŠ¨æœåŠ¡å™¨**: `cd dart_server && ./server.sh` (å¿…é¡»å…ˆå¯åŠ¨)
2. **æ‰§è¡Œæ„å»º**: `./gradlew assembleRelease`
3. **è‡ªåŠ¨æå–**: Gradleæ’ä»¶ä»æ„å»ºäº§ç‰©ä¸­æå–libflutter.soå’Œlibapp.so
4. **åˆ›å»ºZIPåŒ…**: åŒ…å«SOæ–‡ä»¶å’Œå…ƒæ•°æ®ä¿¡æ¯ï¼ˆç‰ˆæœ¬ã€MD5ã€å¤§å°ç­‰ï¼‰
5. **è‡ªåŠ¨ä¸Šä¼ **: ä¸Šä¼ åˆ°æœ¬åœ°DartæœåŠ¡å™¨çš„so_packagesç›®å½•
6. **æ›´æ–°é…ç½®**: è‡ªåŠ¨æ›´æ–°app/src/main/assets/flutterso.jsoné…ç½®æ–‡ä»¶
7. **ç§»é™¤SOæ–‡ä»¶**: ä»APKä¸­åˆ é™¤åŸå§‹SOæ–‡ä»¶ï¼Œå®ç°APKç˜¦èº«

### è¿è¡Œæ—¶åŠ¨æ€åŠ è½½
1. **åº”ç”¨å¯åŠ¨** â†’ æ£€æŸ¥æœ¬åœ°SOæ–‡ä»¶
2. **ç½‘ç»œè¯·æ±‚** â†’ é€šè¿‡127.0.0.1:1234è®¿é—®æœåŠ¡å™¨
3. **ä¸‹è½½SOåŒ…** â†’ è·å–libflutterå’Œlibappçš„ZIPåŒ…
4. **å®Œæ•´æ€§æ ¡éªŒ** â†’ MD5å’Œæ–‡ä»¶å¤§å°éªŒè¯
5. **è§£å‹åŠ è½½** â†’ æå–SOæ–‡ä»¶å¹¶åŠ¨æ€åŠ è½½
6. **Flutterå¯åŠ¨** â†’ åˆå§‹åŒ–Flutterå¼•æ“

## ğŸ” è°ƒè¯•æ–¹æ³•

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
adb logcat | grep FlutterManager

# æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
cd dart_server && cat server.log

# æµ‹è¯•ç½‘ç»œè¿æ¥
adb shell curl -s http://127.0.0.1:1234/api/status

# æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„SOå¤„ç†ä¿¡æ¯
./gradlew assembleRelease --info | grep -E "(flutterSo|appSo)"
```

## ğŸ“Š æ€§èƒ½æ•°æ®

- **APKä½“ç§¯å‡å°‘**: ~70% (ç§»é™¤SOæ–‡ä»¶)
- **SOåŒ…å¤§å°**: Flutterå¼•æ“9MB + åº”ç”¨2.5MB
- **é¦–æ¬¡ä¸‹è½½æ—¶é—´**: çº¦10-15ç§’
- **æ”¯æŒæ¶æ„**: arm64-v8a, armeabi-v7a
- **è‡ªåŠ¨åŒ–ç¨‹åº¦**: 100% (æ— éœ€æ‰‹åŠ¨è„šæœ¬)

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµç¨‹

### æ„å»ºæ–°ç‰ˆæœ¬
### æ„å»ºæ–°ç‰ˆæœ¬
```bash
# 1. å¯åŠ¨æœåŠ¡å™¨ï¼ˆæ„å»ºæ—¶éœ€è¦ä¸Šä¼ SOåŒ…ï¼‰
cd dart_server && ./server.sh

# 2. æ„å»ºAPKï¼ˆè‡ªåŠ¨å¤„ç†SOåŒ…ï¼‰
./gradlew assembleRelease

# 3. å®‰è£…æµ‹è¯•
adb install app/build/outputs/apk/release/app-release.apk
```

### æ–¹æ³•1ï¼šé€šè¿‡åº”ç”¨ç•Œé¢æµ‹è¯•
1. **æ‰“å¼€åº”ç”¨** - åº”ç”¨å·²ç»å®‰è£…å¹¶å¯ä»¥å¯åŠ¨
2. **ç‚¹å‡»"å¯åŠ¨Flutter"æŒ‰é’®** - æµ‹è¯•åŠ¨æ€SOåŠ è½½
3. **ç‚¹å‡»"åŠ¨æ€SOæµ‹è¯•å·¥å…·"æŒ‰é’®** - è¿è¡Œå®Œæ•´åŠŸèƒ½æµ‹è¯•

### æ–¹æ³•2ï¼šé€šè¿‡å‘½ä»¤è¡Œæµ‹è¯•
### æ–¹æ³•2ï¼šé€šè¿‡å‘½ä»¤è¡Œæµ‹è¯•
```bash
# 1. å¯åŠ¨æœåŠ¡å™¨
cd dart_server && ./server.sh

# 2. å¯åŠ¨æµ‹è¯•Activity
adb shell am start -n com.example.flutterdynamic/.DynamicSoTestActivity

# 3. æŸ¥çœ‹å®æ—¶æ—¥å¿—
adb logcat | grep -E "(FlutterManager|DynamicSo)"
```

## ğŸŠ å®ŒæˆçŠ¶æ€

- âœ… ç¼–è¯‘æ—¶è‡ªåŠ¨SOæå–å’Œä¸Šä¼ 
- âœ… è¿è¡Œæ—¶åŠ¨æ€åŠ è½½
- âœ… ç½‘ç»œé€šä¿¡ï¼ˆADBåå‘ç«¯å£æ˜ å°„ï¼‰
- âœ… å®Œæ•´æ€§æ ¡éªŒ
- âœ… ç‰ˆæœ¬ç®¡ç†
- âœ… APKç˜¦èº«
- âœ… å®Œå…¨è‡ªåŠ¨åŒ–ï¼ˆæ— éœ€æ‰‹åŠ¨è„šæœ¬ï¼‰

## ğŸ“ ç­¾åä¿¡æ¯

- **Keystore**: `app/flutter-dynamic.keystore`
- **å¯†ç **: `123456`
- **åˆ«å**: `flutter-dynamic`

---

**è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç”Ÿäº§çº§FlutteråŠ¨æ€SOåŠ è½½è§£å†³æ–¹æ¡ˆï¼Œæ„å»ºæ—¶å®Œå…¨è‡ªåŠ¨åŒ–å¤„ç†ï¼Œå¯ç›´æ¥ç”¨äºå®é™…é¡¹ç›®ï¼** ğŸ‰